(this.webpackJsonpdiceroll=this.webpackJsonpdiceroll||[]).push([[0],{13:function(e,t,n){e.exports=n(25)},18:function(e,t,n){},24:function(e,t,n){},25:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),l=n(12),o=n.n(l),i=(n(18),n(2)),c=n(7),s=n(4),u=n(3),d=n(5),m="d",h="l",p="h",f=function(){function e(t,n){Object(i.a)(this,e),this.type=t,this.text=n}return Object(c.a)(e,[{key:"getNumber",value:function(){return 0!==this.type||this.discard?0:parseFloat(this.text)}}]),e}(),g=function(e){function t(e,n){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,0,n.toString()))).sides=e,a.discard=!1,a}return Object(d.a)(t,e),t}(f);function b(e){return new f(0,e.toString())}function v(e,t){function n(e){return t+e}function a(e,t){return new Error("At position ".concat(n(e),": ").concat(t))}function r(e){return e>="0"&&e<="9"}t=t||0;for(var l=[],o=0,i=null,c=function(t){var c,s=!0,u=l.length>0?l[l.length-1]:null;if(o>0)")"===e[t]?o--:"("===e[t]&&o++,o>0&&(l[l.length-1].text+=e[t]);else if("+"===(c=e[t])||"-"===c||"*"===c||"/"===c||c===m||c===h||c===p){var d=function(n){return a(t,'Operator "'.concat(e[t],'" is missing a ').concat(n," value."))},g=[p,h,m].includes(e[t]);if(null===i||!function(e){return")"===e||r(e)}(i)){if(!g)throw d("left-hand");l.push(b(1))}if(t>0&&g){if(l.length>=2&&l.slice(l.length-2,l.length).some((function(e){return e.text===m})))throw a(t,'Invalid placement of operator "'.concat(e[t],'".'));if(l.length>=1&&2===l[l.length-1].type)throw a(t,"Calculating number of dice in a pool is not supported.")}if(t===e.length-1||""===e.slice(t+1).trim())throw d("right-hand");l.push(new f(1,e[t]))}else if(r(e[t]))if(u&&0===u.type){if(u&&" "===e[t-1])throw a(t,"Invalid spacing between numeric characters.");u.text+=e[t]}else l.push(new f(0,e[t]));else if("("===e[t]){if(null!==i)if(r(i))l.push(new f(1,"*"));else if(i===m)throw a(t,"Calculating number of sides per die is not supported.");o++,l.push(new f(2,"")),l[l.length-1]._pos=n(t)+1}else{if(" "!==e[t])throw a(t,'Unrecognized character "'.concat(e[t],'".'));s=!1}i=s?e[t]:i},s=0;s<e.length;s++)c(s);for(var u=0;u<l.length;u++)2===l[u].type&&(l[u]=v(l[u].text,l[u]._pos));return l}function E(e,t){var n=t||Math.random;return Math.floor(n()*e)+1}function w(e,t,n,a){return t===m?function(e,t,n){for(var a=[],r=0;r<e;r++)a.length>0&&a.push(new f(1,"+")),a.push(new g(t,E(t,n)));return a}(e,n,a):[h,p].includes(t)?function(e,t,n){function a(){throw new Error("Can only keep highest/lowest against a dice pool.")}Array.isArray(n)||a();var r=n.filter((function(e){return void 0!==e.sides}));0===r.length&&a(),r.forEach((function(e){return e.discard=!1}));var l=t===h?function(e,t){return e.getNumber()-t.getNumber()}:function(e,t){return t.getNumber()-e.getNumber()};return r.sort(l).slice(e).forEach((function(e){return e.discard=!0})),n}(e,t,n):b(function(){switch(t){case"+":return e+n;case"-":return e-n;case"*":return e*n;case"/":return e/n;default:return e}}())}function y(e,t,n){for(var a=[],r=0;r<e.length;r++){var l=e[r];if(l.type&&1===l.type&&t.includes(l.text)){var o=a[a.length-1].getNumber(),i=l.text[0],c=e[r+1],s=w(o,i,Array.isArray(c)?c:c.getNumber(),n);a.pop(),a.push(s),r++}else a.push(l)}return a}function C(e){for(var t=e.slice(),n=0;n<t.length;n++)Array.isArray(t[n])&&(t[n]=b(C(t[n])));return t=y(t,["*","/"]),(t=y(t,["+","-"])).length>=1?t[0].getNumber():0}var R={parseSymbols:v,calculate:function(e,t){var n=e.toLowerCase();!function(e){function t(t){var n=new RegExp("\\"+t,"g");return(e.match(n)||[]).length}var n=t("("),a=t(")");if(n!==a)throw new Error("Parentheses mismatch. Counted ".concat(n," opening and ").concat(a," closing."))}(n);var a=v(n);return{expression:e,symbols:a=function e(t,n){return t=y(t=t.map((function(t){return Array.isArray(t)?e(t,n):t})),[m],n),t=y(t,[h,p])}(a,t),total:C(a)}}},O=function(e){function t(){return Object(i.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{class:"alert alert-info help"},r.a.createElement("h2",null,"Help"),r.a.createElement("p",null,r.a.createElement("small",null,r.a.createElement("em",null,"Click the ",r.a.createElement("strong",null,"Help")," button again to dismiss this info box."))),r.a.createElement("p",null,"Any positive integer number can be entered as part of the formula. Numbers are joined together by operators. Operators include:"),r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement("code",null,"d"),": Roll dice. First number is the quantity of dice. Second number is the number of sides per die."),r.a.createElement("li",null,r.a.createElement("code",null,"*"),": Multiply the two numbers."),r.a.createElement("li",null,r.a.createElement("code",null,"/"),": Divide the first number by the second number."),r.a.createElement("li",null,r.a.createElement("code",null,"+"),": Add the two numbers."),r.a.createElement("li",null,r.a.createElement("code",null,"-"),": Subtract the second number from the first number.")),r.a.createElement("p",null,"Calculation honors traditional order of operations. Calculates dice rolls first, then expressions in parentheses, then multiplication and division, then addition and subtraction."),r.a.createElement("p",null,"Examples:",r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement("code",null,"2d6"),": Rolls 2 6-sided dice."),r.a.createElement("li",null,r.a.createElement("code",null,"1d20+5"),": Rolls a 20-sided die and adds 5."),r.a.createElement("li",null,r.a.createElement("code",null,"(4d8+2)/3"),": Rolls 4 8-sided dice and adds 2, then divides by 3."))),r.a.createElement("p",null,"Keep highest/lowest:",r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement("code",null,"3h4d6"),": Rolls 4 6-sided dice and only counts the 3 highest."),r.a.createElement("li",null,r.a.createElement("code",null,"1l2d20+3"),": Rolls 2 20-sided dice, only counts the lowest, and adds 3."))),r.a.createElement("div",{class:"container-fluid"},r.a.createElement("div",{class:"d-flex justify-content-end"},r.a.createElement("button",{class:"btn btn-info",type:"button",onClick:this.props.onCloseRequest},"Close"))))}}]),t}(r.a.Component),j=n(8),D=n(6),k={"+":D.e,"-":D.d,"*":D.f,"/":D.b},x=function(e){return k[e]?r.a.createElement(j.a,{icon:k[e]}):e},A=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,l=new Array(a),o=0;o<a;o++)l[o]=arguments[o];return(n=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(l)))).render=function(){return r.a.createElement("div",{class:"my-2 calculator-buttons"},n.formulaButtonRow([7,8,9,"/"]),n.formulaButtonRow([4,5,6,"*"]),n.formulaButtonRow([1,2,3,"-"]),n.formulaButtonRow(["(",0,")","+"]))},n.formulaButtonRow=function(e){return r.a.createElement("div",{class:"form-row"},e.map((function(e){return n.formulaButton(e)})))},n.formulaButton=function(e){return r.a.createElement("div",{class:"col text-center"},r.a.createElement("button",{class:"btn btn-secondary btn-lg",type:"button",onClick:function(){return n.props.onInput(e)}},x(e)))},n}return Object(d.a)(t,e),t}(r.a.Component),F=function(e){return 100===e.sides?S(e):L(e)},S=function(e){return r.a.createElement(r.a.Fragment,null,q(e,Math.floor((e.text-1)/10)+"0"),q(e,(e.text-1)%10+1))},q=function(e,t){return L({discard:e.discard,sides:10,text:t})},L=function(e){var t=e.discard?" discarded":"",n=H(e.sides,e.text),a="symbol"+t+(e.sides?" die "+n:"");return r.a.createElement("span",{class:a},e.text)},H=function(e,t){var n=B(e);return n?"".concat(n," ").concat(n,"-").concat(t):"coin"},B=function(e){switch(parseInt(e)){case 2:return"coin";case 4:return"d4";case 6:return"d6";case 8:return"d8";case 10:return"d10";case 12:return"d12";case 20:return"d20";default:return null}},P=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,r=new Array(a),l=0;l<a;l++)r[l]=arguments[l];return(n=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).render=function(){return F(n.props.symbol)},n}return Object(d.a)(t,e),t}(r.a.Component),N=function(e){return r.a.createElement(P,{symbol:{sides:e,text:e}})},I=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,l=new Array(a),o=0;o<a;o++)l[o]=arguments[o];return(n=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(l)))).render=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{class:"btn btn-outline-secondary dropdown-toggle",type:"button",id:"commonDiceDropdown","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},N(n.props.value||" ")),r.a.createElement("div",{class:"dropdown-menu","aria-labelledby":"commonDiceDropdown"},n.sidesDropDownOption(2),n.sidesDropDownOption(4),n.sidesDropDownOption(6),n.sidesDropDownOption(8),n.sidesDropDownOption(10),n.sidesDropDownOption(12),n.sidesDropDownOption(20),n.sidesDropDownOption(100)))},n.sidesDropDownOption=function(e){return r.a.createElement("button",{class:"dropdown-item",type:"button",onClick:function(){return n.props.onChange(e)}},N(e))},n}return Object(d.a)(t,e),t}(r.a.Component),M=function(e){return e>1?e:""},K=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(s.a)(this,Object(u.a)(t).call(this,e))).render=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{class:"form-row"},r.a.createElement("div",{class:"col"},r.a.createElement("label",null,"Sides"),r.a.createElement("div",{class:"form-group"},r.a.createElement("div",{class:"input-group"},r.a.createElement("div",{class:"input-group-prepend"},r.a.createElement(I,{value:n.state.sidesPerDie,onChange:n.handleSidesPerDieChange})),r.a.createElement("input",{class:"form-control",type:"number",min:"2",max:"1000",value:n.state.sidesPerDie,onChange:function(e){return n.handleSidesPerDieChange(e.target.value)}})))),r.a.createElement("div",{class:"col"},r.a.createElement("label",null,"Count"),r.a.createElement("div",{class:"form-group"},r.a.createElement("input",{class:"form-control",type:"number",min:"1",max:"1000",value:n.state.dieCount,onChange:n.handleDieCountChange})))),r.a.createElement("div",{class:"form-row"},r.a.createElement("div",{class:"col-7"},r.a.createElement("label",null,"Keep"),r.a.createElement("div",{class:"input-group"},r.a.createElement("div",{class:"input-group-prepend"},r.a.createElement("select",{class:"custom-select",disabled:n.state.dieCount<=1,value:n.state.highLow,onChange:n.handleHighLowChange},r.a.createElement("option",{value:""},"All"),r.a.createElement("option",{value:"h"},"High"),r.a.createElement("option",{value:"l"},"Low"))),r.a.createElement("input",{class:"form-control",type:"number",min:"1",disabled:!n.state.highLow,max:n.state.dieCount-1,value:n.state.highLowCount,onChange:n.handleHighLowCountChange}))),r.a.createElement("div",{class:"col"},r.a.createElement("label",null,"\xa0"),r.a.createElement("div",{class:"form-row"},r.a.createElement("div",{class:"col btn-group text-right"},r.a.createElement("button",{class:"btn btn-secondary",type:"button",title:"Add dice to formula",disabled:!n.state.sidesPerDie,onClick:n.handleDiceAddClick},r.a.createElement(j.a,{icon:D.e})),r.a.createElement("button",{class:"btn btn-outline-primary",type:"button",title:"Set dice as formula and roll now",disabled:!n.state.sidesPerDie,onClick:n.handleRollClick},r.a.createElement(j.a,{icon:D.a})))))))},n.getDiceFormula=function(){return(n.state.highLow?M(n.state.highLowCount)+n.state.highLow:"")+(M(n.state.dieCount)+"d"+n.state.sidesPerDie)},n.adjustHighLowCount=function(e,t){return t?n.state.highLowCount>=e?e-1:n.state.highLowCount:""},n.handleDieCountChange=function(e){var t=e.target.value>1?n.state.highLow:"";n.setState({dieCount:e.target.value,highLow:t,highLowCount:n.adjustHighLowCount(e.target.value,t)})},n.handleHighLowChange=function(e){return n.setState({highLow:e.target.value,highLowCount:n.adjustHighLowCount(n.state.dieCount,e.target.value)})},n.handleHighLowCountChange=function(e){return n.setState({highLowCount:e.target.value})},n.handleSidesPerDieChange=function(e){return n.setState({sidesPerDie:e})},n.handleDiceAddClick=function(){return n.props.onDiceAddClick(n.getDiceFormula())},n.handleRollClick=function(){return n.props.onRollClick(n.getDiceFormula())},n.state={dieCount:null,sidesPerDie:6,highLow:"",highLowCount:null},n}return Object(d.a)(t,e),t}(r.a.Component),U=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(s.a)(this,Object(u.a)(t).call(this,e))).dialogs={dice:{label:"Dice",content:r.a.createElement(K,{onDiceAddClick:n.props.onFormulaAddRequest,onRollClick:n.props.onRollRequest})},calc:{label:"Math",content:r.a.createElement(A,{onInput:n.props.onFormulaAddRequest})}},n.state={openDialog:n.dialogs.dice},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{class:"row justify-content-center d-lg-none"},r.a.createElement("div",{class:"btn-group"},Object.values(this.dialogs).map((function(t){return r.a.createElement("button",{class:"btn btn-outline-secondary btn-sm"+(e.state.openDialog===t?" active":""),onClick:function(){return e.setState({openDialog:t})}},t.label)})))),r.a.createElement("div",{class:"row justify-content-center"},Object.values(this.dialogs).map((function(t){return r.a.createElement("div",{class:"col-lg-4"+(e.state.openDialog===t?"":" d-none d-lg-block")},t.content)}))))}}]),t}(r.a.Component),_=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(s.a)(this,Object(u.a)(t).call(this,e))).setDialog=function(e){return n.setState({openDialog:n.state.openDialog===e?null:e})},n.handleFormulaAddRequest=function(e){return n.props.onSetFormulaRequest(n.formulaField.current.value+e)},n.handleHelpClick=function(){return n.setDialog(n.dialogs.help)},n.handleRollRequest=function(e){return n.props.onRollRequest(e)},n.handleRollClick=function(){return n.handleRollRequest()},n.handleFormulaKeyUp=function(e){13===e.keyCode&&n.props.onRollRequest()},n.dialogs={tools:{tooltip:"Formula Building Tools",icon:D.h,content:r.a.createElement(U,{onFormulaAddRequest:n.handleFormulaAddRequest,onRollRequest:n.handleRollRequest})},help:{tooltip:"Formula Help",icon:D.c,content:r.a.createElement(O,{onCloseRequest:n.handleHelpClick})}},n.formulaField=r.a.createRef(),n.state={openDialog:null},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=function(t){return r.a.createElement("button",{type:"button",title:t.tooltip,class:(n=e.state.openDialog===t,"btn btn-outline-secondary"+(n?" active":"")),onClick:function(){return e.setDialog(t)}},r.a.createElement(j.a,{icon:t.icon}));var n},n=function(n){return r.a.createElement("div",{class:n},t(e.dialogs.tools),t(e.dialogs.help),r.a.createElement("button",{class:"btn btn-outline-danger",type:"button",title:"Clear Formula",onClick:function(t){return e.props.onSetFormulaRequest("")}},r.a.createElement(j.a,{icon:D.g})))};return r.a.createElement("div",{class:"form-group mt-2"},r.a.createElement("div",{class:"form-group"},r.a.createElement("label",{for:"rollFormula"},"Formula"),r.a.createElement("div",null,n("form-group btn-group d-sm-none")),r.a.createElement("div",{class:"input-group"},n("input-group-prepend d-none d-sm-inline-block"),r.a.createElement("input",{type:"text",class:"form-control",ref:this.formulaField,onKeyUp:this.handleFormulaKeyUp,onChange:function(t){return e.props.onSetFormulaRequest(t.target.value)},value:this.props.formula}),r.a.createElement("div",{class:"input-group-append"},r.a.createElement("button",{class:"btn btn-primary",type:"submit",title:"Roll",onClick:this.handleRollClick},r.a.createElement(j.a,{icon:D.a}))))),Object.values(this.dialogs).map((function(t){return r.a.createElement("div",{class:e.state.openDialog===t?"":"d-none"},t.content)})))}}]),t}(r.a.Component),z=function(e){function t(){return Object(i.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{class:"history"},this.renderHistory())}},{key:"renderHistory",value:function(){var e=this.props.rolls.length-1,t=this;return this.props.rolls.map((function(n,a){var l=a===e?" latest":"",o="row align-items-center"+l,i="result"+l;return r.a.createElement("div",{class:o},r.a.createElement("div",{class:"col-md-8"},t.renderSymbols(n.symbols)),r.a.createElement("div",{class:"col-md-3 text-right"},r.a.createElement("span",{class:i},n.total)),r.a.createElement("div",{class:"col-md-1 text-right"},r.a.createElement("button",{class:"btn btn-outline-primary btn-sm",type:"button",title:n.expression,onClick:function(){return t.props.onReRollRequest(n.expression)}},"Re-roll")))})).reverse()}},{key:"renderSymbols",value:function(e){var t=this,n=r.a.createElement(P,{symbol:{text:"("}}),a=r.a.createElement(P,{symbol:{text:")"}});return e.map((function(l){if(Array.isArray(l)){var o=e.length>1&&(l.length>1||Array.isArray(l[0]));return r.a.createElement("span",null,o?n:"",t.renderSymbols(l),o?a:"")}return e.some((function(e){return e.sides}))&&"+"===l.text?"":r.a.createElement(P,{symbol:l})}))}}]),t}(r.a.Component),G=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(s.a)(this,Object(u.a)(t).call(this,e))).roll=function(e){try{var t=R.calculate(e||n.state.formula);n.addResult(t)}catch(a){n.setState({formulaError:a})}},n.handleRollRequest=function(e){var t=void 0!==e?e:n.state.formula;n.setState({formula:t}),n.roll(t)},n.maxResults=50,n.state={formula:null,formulaError:null,results:[]},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=this.state.formulaError?r.a.createElement("div",{class:"alert alert-danger",role:"alert"},this.state.formulaError.message):"";return r.a.createElement("div",{class:"container"},r.a.createElement(_,{formula:this.state.formula,onSetFormulaRequest:function(t){return e.setState({formula:t})},onRollRequest:this.handleRollRequest}),t,r.a.createElement(z,{rolls:this.state.results,onReRollRequest:this.handleRollRequest}))}},{key:"addResult",value:function(e){var t=this.state.results;t.push(e),t.length>this.maxResults&&t.splice(0,1),this.setState({results:t,formulaError:null})}}]),t}(r.a.Component);n(24);var J=function(){return r.a.createElement("div",{className:"App"},r.a.createElement("nav",{class:"navbar navbar-dark bg-dark"},r.a.createElement("a",{class:"navbar-brand",href:"."},r.a.createElement("img",{src:"image/icon.svg",width:"30",height:"30",class:"d-inline-block align-top",alt:""}),"Diceroll"),r.a.createElement("a",{class:"nav-link p-2",href:"https://github.com/aaaantoine/diceroll",target:"_blank",rel:"noopener noreferrer","aria-label":"GitHub"},r.a.createElement("svg",{class:"navbar-nav-svg",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 499.36",focusable:"false"},r.a.createElement("title",null,"GitHub"),r.a.createElement("path",{d:"M256 0C114.64 0 0 114.61 0 256c0 113.09 73.34 209 175.08 242.9 12.8 2.35 17.47-5.56 17.47-12.34 0-6.08-.22-22.18-.35-43.54-71.2 15.49-86.2-34.34-86.2-34.34-11.64-29.57-28.42-37.45-28.42-37.45-23.27-15.84 1.73-15.55 1.73-15.55 25.69 1.81 39.21 26.38 39.21 26.38 22.84 39.12 59.92 27.82 74.5 21.27 2.33-16.54 8.94-27.82 16.25-34.22-56.84-6.43-116.6-28.43-116.6-126.49 0-27.95 10-50.8 26.35-68.69-2.63-6.48-11.42-32.5 2.51-67.75 0 0 21.49-6.88 70.4 26.24a242.65 242.65 0 0 1 128.18 0c48.87-33.13 70.33-26.24 70.33-26.24 14 35.25 5.18 61.27 2.55 67.75 16.41 17.9 26.31 40.75 26.31 68.69 0 98.35-59.85 120-116.88 126.32 9.19 7.9 17.38 23.53 17.38 47.41 0 34.22-.31 61.83-.31 70.23 0 6.85 4.61 14.81 17.6 12.31C438.72 464.97 512 369.08 512 256.02 512 114.62 397.37 0 256 0z",fill:"currentColor","fill-rule":"evenodd"})))),r.a.createElement(G,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(J,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[13,1,2]]]);
//# sourceMappingURL=main.d87c1e93.chunk.js.map